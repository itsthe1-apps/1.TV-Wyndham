Ext.ux.ScriptManager=Ext.extend(Ext.util.Observable,{timeout:30,scripts:[],disableCaching:false,constructor:function(a){Ext.apply(this,a);Ext.ux.ScriptManager.superclass.constructor.call(this,a)},loadJs:function(a){if(!a){return}if(a.debug){this.addAsScript(a);return}if(!Ext.isArray(a.scripts)){a.scripts=[a.scripts]}a.url=a.scripts.shift();if(a.scripts.length==0){this._loadUrl(a)}else{a.scope=this;this._loadUrl(a,function(){this.loadJs(a)})}},loadCss:function(c){var d=c.id||"";var b;if(!Ext.isArray(c.scripts)){c.scripts=[c.scripts]}for(var a=0;a<c.scripts.length;a++){b=c.scripts[a];d=""+Math.floor(Math.random()*100);Ext.util.CSS.createStyleSheet("",d);Ext.util.CSS.swapStyleSheet(d,b)}if(c.callback&&Ext.isFunction(c.callback)){c.callback.createDelegate(c.scope||window).call()}},addAsScript:function(e){var d=0;var a;var c=e.scripts;if(!Ext.isArray(c)){c=[c]}var b=document.getElementsByTagName("head")[0];Ext.each(c,function(f){a=document.createElement("script");a.type="text/javascript";if(Ext.isFunction(e.callback)){a.onload=a.onreadystatechange=function(){d++;if(d==c.length){e.callback.call()}}}a.src=f;b.appendChild(a)})},_loadUrl:function(b,d){var a,c;if(typeof b=="object"){a=b;b=a.url;d=d||a.callback;c=a.scope;if(typeof a.timeout!="undefined"){this.timeout=a.timeout}if(typeof a.disableCaching!="undefined"){this.disableCaching=a.disableCaching}}if(this.scripts[b]){if(d&&Ext.isFunction(d)){d.createDelegate(c||window).call()}return null}Ext.Ajax.request({url:b,success:this.processSuccess,failure:this.processFailure,scope:this,timeout:(this.timeout*1000),disableCaching:this.disableCaching,argument:{url:b,scope:c||window,callback:d,options:a}});return null},processSuccess:function(response){this.scripts[response.argument.url]=true;window.execScript?window.execScript(response.responseText):window.eval(response.responseText);if(response.argument.options.scripts.length==0){}if(typeof response.argument.callback=="function"){response.argument.callback.call(response.argument.scope)}},processFailure:function(a){Ext.MessageBox.show({title:"Application Error",msg:"Script library could not be loaded.",closable:false,icon:Ext.MessageBox.ERROR,minWidth:200,buttons:Ext.Msg.OK});setTimeout(function(){Ext.MessageBox.hide()},2000)}});ScriptMgr=new Ext.ux.ScriptManager();