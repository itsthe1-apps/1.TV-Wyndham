var RadioManager={isNewData:false,channelArray:[],data:[],channelLoaded:false,currentChannel:null,channelList:null,channelFullList:null,favouriteList:"",categoriesData:[],init:function(){this.channelList=new top.List(top.ListType.SCROLL_CYCLIC,null);this.channelList.display=function(){}},loadFlag:function(b){top.kwUtils.kwXMLHttpRequest("GET",top.RADIOCAT_URL,true,this,this.loadCategories)},loadCategories:function(a){try{a=(typeof a==="object")?a:eval(a);this.isNewData=true;var r=[];for(var d=0;d<a.length;d++){var c=new top.RadioCategory(a[d].id,a[d].name,a[d].name);r.push(c)}this.categoriesData=a;if(this.categoriesData.length){this.loadCategoryData(null)}}catch(e){top.kwConsole.print("RADIO_CATEGORIES_LOAD_ERROR")}},loadCategoryData:function(b){b=b?b:0;var a=top.RADIOS_URL+top.USER_ID+"/gid/"+b+"/format/json";if(b==0){top.kwUtils.kwXMLHttpRequest("GET",a,true,this,this.getCategoryFullData)}else{top.kwUtils.kwXMLHttpRequest("GET",a,true,this,this.getCategoryData)}},getCategoryFullData:function(a){try{a=(typeof a==="object")?a:eval(a);this.isNewData=true;var r=[];for(var d=0;d<a.length;d++){var c=new top.Radio(a[d].id,a[d].number,a[d].name,a[d].description,a[d].mrl,a[d].logo,a[d].epgXML,a[d].eitXML);r.push(c)}this.setData(r);this.channelFullList=r}catch(e){top.kwConsole.print("RADIOS_LOAD_ERROR")}},getCategoryData:function(a){try{a=(typeof a==="object")?a:eval(a);this.isNewData=true;var r=[];for(var d=0;d<a.length;d++){var c=new top.Radio(a[d].id,a[d].number,a[d].name,a[d].description,a[d].mrl,a[d].logo,a[d].epgXML,a[d].eitXML);r.push(c)}this.setData(r)}catch(e){top.kwConsole.print("RADIOS_LOAD_ERROR")}},getCategoriesData:function(){return this.categoriesData},setData:function(b){this.channelList.setData(b);return true},loadFavouriteChannel:function(){url=top.RADIOS_GETFAVURL+top.USER_ID+"/format/json";top.kwUtils.kwXMLHttpRequest("GET",url,true,this,this.getFavouriteChannel)},getFavouriteChannel:function(b){try{b=(typeof b==="object")?b:eval(b);var r=[];for(var d=0;d<b.length;d++){var c=new top.Radio(b[d].id,b[d].number,b[d].name,b[d].description,b[d].mrl,b[d].logo);r.push(c)}this.clearChannelList();this.channelLoaded=true;this.setData(r);top.ScreenManager.load("RADIO_LIST",{type:"favourite"})}catch(e){this.setData(this.channelFullList);top.ScreenManager.load("RADIO_LIST")}},loadAllChannel:function(){var a=top.RADIOS_URL+top.USER_ID+"/gid/"+0+"/format/json";top.kwUtils.kwXMLHttpRequest("GET",a,true,this,this.getAllChannel)},getAllChannel:function(b){try{b=(typeof b==="object")?b:eval(b);var r=[];for(var d=0;d<b.length;d++){var c=new top.Radio(b[d].id,b[d].number,b[d].name,b[d].description,b[d].mrl,b[d].logo);r.push(c)}this.clearChannelList();this.channelLoaded=true;this.setData(r);top.ScreenManager.load("RADIO_LIST",{type:"all"})}catch(e){}},setFavouriteChannel:function(a){top.kwUtils.kwXMLHttpRequest("POST",a,true)},removeFavouriteChannel:function(a){top.kwUtils.kwXMLHttpRequest("POST",a,true)},chChooserLoadChannels:function(b){b=b?b:0;var a=top.RADIOS_URL+top.USER_ID+"/gid/"+b+"/format/json";top.kwUtils.kwXMLHttpRequest("GET",a,true,this,this.chChoosergetChannels)},chChoosergetChannels:function(a){try{a=(typeof a==="object")?a:eval(a);this.channelLoaded=true;var r=[];for(var d=0;d<a.length;d++){var c=new top.Radio(a[d].id,a[d].number,a[d].name,a[d].description,a[d].mrl,a[d].logo);r.push(c)}this.channelArray=r;this.setData(this.channelArray);top.ScreenManager.load("RADIO_LIST",{type:"genre",genreId:top.DEFAULT_RADIO_CATEGORY})}catch(e){top.kwConsole.print("RADIOS_LOAD_ERROR")}},getChannels:function(a){try{this.channelLoaded=true;a=(a==""?"[]":a);this.channelArray=a;this.setData(this.channelArray)}catch(c){top.kwConsole.print("RADIOS_LOAD_ERROR")}},getChannelList:function(){return this.channelList.getData()},getAllChannelList:function(){return this.allchannelList.getData()},clearChannelList:function(){this.channelLoaded=false;this.channelArray=[];this.channelList=null;this.channelList=new top.List(top.ListType.SCROLL_CYCLIC,null);this.channelList.display=function(){}},addChannel:function(a){this.channelArray.push(a)},getChannelIndex:function(b){if(b){for(var a=0;a<this.channelList.getLength();a++){if(this.channelList.getItem(a).id==b.id){return a}}}return null},getChannelById:function(b){if(b){for(var a=0;a<this.channelList.getLength();a++){if(this.channelList.getItem(a).id==b){return this.channelList.getItem(a)}}}return null},getCurrentChannel:function(){if(this.currentChannel==null){this.currentChannel=this.channelList.getItem()}return this.currentChannel},setCurrentChannel:function(a){this.currentChannel=a;if(this.channelList.getItem().channelNumber!=a){if(!isNaN(this.getChannelIndex(a))){this.channelList.setIndex(this.getChannelIndex(a))}}},getChannelIndex:function(b){if(b){for(var a=0;a<this.channelList.getLength();a++){if(this.channelList.getItem(a).id==b.id){return a}}}return null},getChannelByIndex:function(a){return((isNaN(a)||a==null)?null:this.channelList.getItem(a))},getChannelIndexByProperty:function(c,b){var e=0,d=false;var a=this.channelList;var f=a.getLength();while(e<f&&!d){a.getItem(e)[c]==b?d=true:e++}return d?e:null},getChannelByNumber:function(a){return this.getChannelByIndex(this.getChannelIndexByProperty("channelNumber",a))},channelUp:function(a){this.channelList.scrollDown();if(a==true){this.setCurrentChannel(this.channelList.getItem())}},channelDown:function(a){this.channelList.scrollUp();if(a==true){this.setCurrentChannel(this.channelList.getItem())}}};