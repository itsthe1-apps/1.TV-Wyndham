var epgChannelList=null;var epgGridTime=null;function epgEventHandler(d){var c=true;switch(d.code){case"INIT_SCREEN":epgInitScreen(d.args);break;case"UNINIT_SCREEN":epgUninitScreen();break;case"KEY_GUIDE":top.ScreenManager.load("FSV");break;default:switch(top.State.getState()){case top.State.EPG_MAIN:c=epgMainEventHandler(d);break;default:c=false;break}break}return c}function epgMainEventHandler(d){var c=true;switch(d.code){case"KEY_UP":epgChannelList.scrollUp();break;case"KEY_DOWN":epgChannelList.scrollDown();break;case"KEY_LEFT":epgGridTime=epgGetGridTime(-1);epgGridChangeProgram();break;case"KEY_RIGHT":epgGridTime=epgGetGridTime(1);epgGridChangeProgram();break;case"KEY_SELECT":if(epgChannelList.getItem()){top.EPGChannelManager.setCurrentChannel(epgChannelList.getItem());top.ScreenManager.load("FSV")}break;default:c=false;break}return c}function epgActionHandler(c,d){switch(c){}}function epgInitScreen(b){top.ScreenManager.displayScreen(epgGetScreenHtml());top.Player.setAlphaLevel(top.TRANSPARENCY_LEVEL);top.State.setState(top.State.EPG_MAIN);top.Player.setFullScreen();epgGridTime=new Date().getTime();try{epgChannelListInit()}catch(c){x2=c}epgUpdateGridDate();epgUpdateGridTimeLine()}function epgUninitScreen(){setToBinEPG();top.Player.setAlphaLevel(100)}function epgChannelListInit(){epgChannelList=new top.List(top.ListType.SCROLL_CYCLIC,top.EPGChannelManager.getChannelList(),0,0,0,8,document.getElementById("epgChannelListContainer"));epgChannelList.displayItem=epgChannelListDisplayItem;epgChannelList.onAfterDisplay=function(){this.displayPrograms();epgUpdateProgramInfo()};epgChannelList.displayProgram=epgDisplayProgram;epgChannelList.displayPrograms=epgDisplayPrograms;epgChannelList.initList()}function epgGetSelectedProgramIndex(){var f=null;var d=epgChannelList.getItem();if(d&&d.programs){f=d.programs;for(var e=0;e<f.length;e++){if(f[e].startTime<epgGridTime&&f[e].endTime>epgGridTime){return e}}}return null}function epgGetSelectedProgram(){var b=epgGetSelectedProgramIndex();if(!isNaN(b)){return epgChannelList.getItem().programs[b]}return null}function epgGetGridTime(h){var f=new Date().getTime();var i=epgGetSelectedProgramIndex();var j=epgChannelList.getItem().programs;var g=new top.Iterator(0,i,j?j.length:0,false);if(h==1){g.increaseIndex()}else{g.decreaseIndex()}if(j[g.getIndex()]){return Math.max(f,(j[g.getIndex()].startTime+1000))}else{return f}}function epgGridChangeProgram(){epgChannelList.onAfterDisplay();epgUpdateGridDate();epgUpdateGridTimeLine()}function setToBinEPG(){epgChannelList=null;delete epgChannelList;epgChannelList=undefined;epgGridTime=null;delete epgGridTime;epgGridTime=undefined};